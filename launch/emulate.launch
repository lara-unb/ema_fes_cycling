<!--

The launch file is an XML that specifies which parameters to set and ROS
nodes to launch. It's used with a roslaunch command, which is responsible
for doing the initial setup and starting the system. The launch file includes
options to automatically respawn processes that have already died. This
file is usually in the /launch subdirectory of a package. For a specification
of this XML format, see:
http://wiki.ros.org/roslaunch/XML

-->

<launch>
    <group ns="ema">

        <!-- declare and load launch arguments-->
        <arg name="platform" value="pc" doc="specify which platform to use: rasp/pc"/>
        <param name="platform" value="$(arg platform)"/>

        <!-- load common config files-->
        <rosparam command="load" file="$(find ema_fes_cycling)/config/imu.yaml" ns="imu"/>
        <rosparam command="load" file="$(find ema_fes_cycling)/config/stim.yaml" ns="stimulator"/>
        <rosparam command="load" file="$(find ema_fes_cycling)/config/trike.yaml" ns="trike"/>

        <!-- launch common nodes -->
        <node name="imu_emulator" pkg="ema_fes_cycling" type="imu_emulator.py" output="log" respawn="true" respawn_delay="5"/>
        <node name="trike" pkg="ema_fes_cycling" type="trike_node.py" output="log" respawn="true" respawn_delay="5"/>

        <!-- launch pc-exclusive nodes -->
        <group if="$(eval platform == 'pc')">
            <node name="trike_config" pkg="ema_fes_cycling" type="trike_server_node.py" output="screen" respawn="true" respawn_delay="5"/>
            <node name="dashboard" pkg="rqt_gui" type="rqt_gui" output="screen" args="--perspective-file $(find ema_fes_cycling)/perspective/EMA_Trike.perspective"/>
        </group>

        <!-- launch rasp-exclusive nodes -->
        <group if="$(eval platform == 'rasp')">
            <node name="interface" pkg="ema_fes_cycling" type="interface_node.py" output="screen" respawn="true" respawn_delay="5"/>
            <node name="display" pkg="ema_fes_cycling" type="display_emulator.py" output="screen" respawn="true" respawn_delay="5"/>
            <!-- <node name="imu" pkg="yostlabs_3space_imu" type="imu_node.py" output="log" respawn="true" respawn_delay="5"/> -->
            <!-- <node name="stimulator" pkg="hasomed_rehastim_stimulator" type="stimulator_node.py" output="log" respawn="true" respawn_delay="5"/> -->
        </group>

    </group>
</launch>
